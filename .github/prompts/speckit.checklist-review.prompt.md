---
agent: speckit.checklist-review
---
# SpecKit チェックリストレビュー

機能仕様のチェックリストをレビューし、現在のフェーズに応じた確認結果とアクション提案を出力します。

## 入力

- `$SPEC_DIR`: 機能仕様ディレクトリのパス（spec.mdが存在するディレクトリ）

## 手順

### Step 1: フェーズ判定

`$SPEC_DIR`内のファイル存在状況を確認し、現在のフェーズを判定します。

| フェーズ | 判定条件 |
|----------|----------|
| **plan実行前** | spec.mdあり、plan.mdなし |
| **tasks実行前** | spec.md + plan.mdあり、tasks.mdなし |
| **tasks実行後** | spec.md + plan.md + tasks.mdあり |

### Step 2: チェックリスト検出

`$SPEC_DIR/checklists/*.md`を動的に検出し、すべてのチェックリストファイルをレビュー対象とします。

### Step 3: マーカー分類とカウント

各チェックリストファイルの項目を以下のマーカーで分類・集計します。

#### 完了扱いマーカー
- `[x]` + `[RESOLVED]`: spec.md/plan.md/tasks.mdに解決内容が反映済み
- `[x]` + `[COVERED]`: constitution.mdでカバー済み
- `[x]` + `[WONT_DO]`: 対応しないことを決定
- `[x]` + `[Spec §X.Y]`: 仕様の該当セクションで定義済み

#### 未解決マーカー（要対応）
- `[ ]` + `[NEEDS CLARIFICATION]`: 仕様の明確化が必要
- `[ ]` + `[Gap]`: 仕様に欠落あり
- `[ ]` + `[Ambiguity]`: 曖昧な表現あり
- `[ ]` + `[Clarity]`: 明確化が必要

#### 後回し可能マーカー
- `[ ]` + `[Consistency]`: 一貫性の確認（詳細設計時に確認可能）
- `[ ]` + マーカーなし: 一般的な確認項目

### Step 4: フェーズ別チェック項目の分類

#### plan実行前

| 区分 | 対象 | 理由 |
|------|------|------|
| **必須確認** | `[NEEDS CLARIFICATION]`マーカー付き項目 | plan策定に仕様の確定が必須 |
| **必須確認** | `[Gap]`マーカー付き項目 | 仕様の欠落はplan前に解決すべき |
| **必須確認** | `[Ambiguity]`マーカー付き項目 | 曖昧な要件はplan前に明確化すべき |
| **必須確認** | `[Clarity]`マーカー付き項目 | 不明確な要件はplan前に明確化すべき |
| **後回し可能** | `[Consistency]`マーカー付き項目 | 詳細設計時に確認可能 |
| **後回し可能** | マーカーなしの未チェック項目 | 詳細スタイル等はplan後に決定可能 |

#### tasks実行前

| 区分 | 対象 | 理由 |
|------|------|------|
| **必須確認** | 全チェックリストの残り未解決項目 | タスク分解前に仕様を確定すべき |
| **必須確認** | plan.mdとspec.mdの整合性 | 計画が要件を満たしているか確認 |

#### tasks実行後

| 区分 | 対象 | 理由 |
|------|------|------|
| **必須確認** | タスクが全要件をカバーしているか | 実装漏れ防止 |
| **必須確認** | 未解決項目がタスクに反映されているか | 対応漏れ防止 |

### Step 5: レビュー結果の出力

以下のフォーマットでMarkdown出力します。

```markdown
## チェックリストレビュー結果

### 📍 フェーズ判定

| 項目 | 状態 |
|------|------|
| 現在のフェーズ | **{フェーズ名}** |
| spec.md | ✅ / ❌ |
| plan.md | ✅ / ❌ |
| tasks.md | ✅ / ❌ |

### 📋 レビュー対象チェックリスト

{検出されたチェックリストファイル一覧}

### ✅ 今回確認する項目（必須）

**{チェックリスト名}**

| カテゴリ | 完了 | 未解決 | マーカー |
|----------|------|--------|----------|
| {カテゴリ名} | X/Y | Z | [Gap], [Ambiguity]等 |

{未解決項目の詳細リスト}

### ⏳ 次フェーズで確認予定（後回し可能）

**{チェックリスト名}**
- {カテゴリ名}（X項目）
- ...

💡 これらの項目は{次フェーズ名}で確認します

### 📊 サマリー

| 指標 | 件数 |
|------|------|
| 必須確認項目（完了） | X |
| 必須確認項目（未解決） | Y |
| 後回し可能項目 | Z |
| 合計 | N |

### 🎯 推奨アクション

{フェーズに応じた推奨アクション}

- ✅ 全ての必須項目が完了している場合:
  → `/speckit.{次コマンド}` を実行して{次フェーズ}に進めます

- ⚠️ 未解決の必須項目がある場合:
  → 以下の項目を解決してください（警告付きで進行は可能）
  - {未解決項目リスト}
```

## 出力例

### plan実行前の場合

```markdown
## チェックリストレビュー結果

### 📍 フェーズ判定

| 項目 | 状態 |
|------|------|
| 現在のフェーズ | **plan実行前** |
| spec.md | ✅ |
| plan.md | ❌ |
| tasks.md | ❌ |

### 📋 レビュー対象チェックリスト

- requirements.md
- ux.md

### ✅ 今回確認する項目（必須）

**requirements.md** - 仕様品質チェックリスト

| カテゴリ | 完了 | 未解決 |
|----------|------|--------|
| コンテンツ品質 | 4/4 | 0 |
| 要件の完全性 | 8/8 | 0 |
| 機能の準備状況 | 4/4 | 0 |

**ux.md** - UX要件品質チェックリスト（必須項目のみ）

| マーカー | 完了 | 未解決 |
|----------|------|--------|
| [Gap] | 0 | 15 |
| [Ambiguity] | 4 | 2 |
| [Clarity] | 1 | 1 |

未解決の必須項目:
- [ ] CHK001 タスク一覧のレイアウト構造... [Gap]
- [ ] CHK006 「視覚的に区別される」の具体的な視覚表現... [Ambiguity]
- ...

### ⏳ 次フェーズで確認予定（後回し可能）

**ux.md** - UX要件品質チェックリスト
- [Consistency] 状態表示要件の一貫性（3項目）
- マーカーなし（2項目）

💡 これらの項目はtasks実行前フェーズで確認します

### 📊 サマリー

| 指標 | 件数 |
|------|------|
| 必須確認項目（完了） | 22 |
| 必須確認項目（未解決） | 18 |
| 後回し可能項目 | 5 |
| 合計 | 45 |

### 🎯 推奨アクション

⚠️ **18件の未解決必須項目があります**

次フェーズに進む前に、以下の対応を推奨します：
1. spec.mdに詳細を追記して `[RESOLVED]` マーカーを付ける
2. constitution.mdでカバーされている場合は `[COVERED]` マーカーを付ける
3. 対応しない場合は `[WONT_DO]` マーカーを付ける

→ 必須項目を解決後、`/speckit.plan` を実行してplan.mdを作成できます
→ 警告を承知で進める場合も `/speckit.plan` を実行可能です
```